{"componentChunkName":"component---src-templates-blog-post-js","path":"/week_2/","result":{"data":{"site":{"siteMetadata":{"title":"Antony's Blog"}},"markdownRemark":{"id":"a5dc9171-f15b-55a3-a5ba-7dbc1215efdb","excerpt":"Emotion Analysis using Machine Learning  The Machine Learning models used are : SGDClassifier loss=‘hinge’ as hyperparameter  The model used because it…","html":"<h2>Emotion Analysis using Machine Learning</h2>\n<p><code class=\"language-text\">2nd week of blogging</code></p>\n<h3>The Machine Learning models used are :</h3>\n<h4>SGDClassifier</h4>\n<ul>\n<li>loss=‘hinge’ as hyperparameter </li>\n<li>The model used because it converges faster than other descent techniques</li>\n</ul>\n<p>Results:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Model Performance metrics:\n------------------------------\nAccuracy: 0.8486\nPrecision: 0.8429\nRecall: 0.8486\nF1 Score: 0.8411</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Model Classification report:\n------------------------------\n              precision    recall  f1-score   support\n\n       Anger       0.72      0.61      0.66      1459\n         Bad       0.38      0.18      0.24      1810\n      Digust       0.58      0.37      0.45       206\n        Fear       0.92      0.88      0.90     12716\n       Happy       0.71      0.90      0.80      7672\n         Sad       0.92      0.92      0.92     16902\n    Surprise       0.62      0.39      0.48       844\n\n    accuracy                           0.85     41609\n   macro avg       0.69      0.61      0.64     41609\nweighted avg       0.84      0.85      0.84     41609</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/989c7cba2e231992224014743af046af/00b70/clf.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.75675675675677%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAAD/UlEQVQ4y0WU7U9bZRjG+0H96Df/CGgpLX07bCwrTJNFyXwlM8sgIRtuE6dsgIOFZIq8dCAM0E2zGJbM+GF+VefQuShTBwwGAjoYG5Sy0hdaaEvfaAs/73M240nunOckz3Pd131d13N0isOBUrwLpbyavW8e53RDE41nmqlvPEPd6QbeP9XAyboGjp+sp7auUepD3pN389kWjp+oxeGwUVTkxGbbjaI40DnsNqxKCYZT13nRNcFaNEMqA/H0DptpCMa2pXa0ty+yzbR7kwerSXaA8XuzOOwm9MYqzJaXKVYs6OwCuHuPk3PfjDNww80jXxxvKE0kkWUjnsEbTjO/mmBweIVro6vMLseYf7xJVhBH7v6F3WrEuKsWs+NVFIcZndVqpbS0FL8/wFZmh5G5MBMLG6S2ssRTWTzBBLfnQigdd6j4YpL7K1HcgTiJLfhjdFIDNL1Uj2XPWyh2AbTZbAJYxpw7IGPlhGGCBV+ScTk4sRLDs5ZienmTzh8W+fwXD2OPokx7YmzLyGP3ZrCZDVhfP4tt30EUm+kJ4F6nkzszyyz4k4QjKZbX4rQOzdP76yJriRwhqSV/nDkZ9dtRLz/NBJFhGJ2Y0gCLD5/Dsf9tHJbC/0YuY14YhuLbROJZgmLM8FKEodkAPReHuXx1jEVp9lCYT7hj/C3A6jM+NYOlUM++Y22UHDiMvUgAzWYzTmcpHq9f3N1hPZpiPZbWXHzwMMjzLzRgVrqIpLYRnwhuJAnJni2ZeWR8iiKjngMfuCh7o0rYGlWGFkrLyvAGQqRlU1ROxZI57YBvLUF7903au36mu+8mg1+PEFhPE4ykNQ3vTs5gMuRT2dzN/ooqLCbjEw2d4rL7sU+c2yYs3TckgFGxUS31mb3v49nnjkrWPiKWypGUzCQzamymKBTA2o97ee1QNUWFTwE1hv4w6Rwau00ZLynjqw3U9ZI43tk1JHWD9o7v+GpwmJzGcBaDPo+mjgEOVh7BVFiAzmKxiIZOljw+yZ2YorKTQMeSW1IZTc+NzadM/1nlGZ2Ib2nRvqempjHk59HafZFDVUcoNBb8n0OPN0hCrlpI9AnHMnL1cjJeFv9GGreEe3ghzPVxD590fE/PpVv85o5z5cc/0Qugq/cSVdU1GFVANTYqw0Aopjm7nkAcRRNd5eWP7rCwluXLES/XpsMkZJNkm47fA9RfvaUBXrp8hZpj71JgMKh32U5JSQmdrm76Bi5y/tN+unoHuND/mVad3f20nu+jprmD2hYXba4LtLT1UNnkouJEI2rsjta8wyvl5fLXKUKnKIr8ghwirh6DdFC7FBQYZP3kOz8vT1ubZRyTlF6fr2llLtBjNZtQz6tAqnTq+l/OrYsYTV49hwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"fig:\"\n        title=\"fig:\"\n        src=\"/static/989c7cba2e231992224014743af046af/fcda8/clf.png\"\n        srcset=\"/static/989c7cba2e231992224014743af046af/12f09/clf.png 148w,\n/static/989c7cba2e231992224014743af046af/e4a3f/clf.png 295w,\n/static/989c7cba2e231992224014743af046af/fcda8/clf.png 590w,\n/static/989c7cba2e231992224014743af046af/00b70/clf.png 733w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h4>LogisticRegression</h4>\n<ul>\n<li>penalty=‘l2’, C=1 as hyperparameter</li>\n<li>The model used because its simplest model</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Model Performance metrics:\n------------------------------\nAccuracy: 0.8488\nPrecision: 0.8477\nRecall: 0.8488\nF1 Score: 0.8469</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Model Classification report:\n------------------------------\n              precision    recall  f1-score   support\n\n       Anger       0.75      0.62      0.68      1459\n         Bad       0.39      0.40      0.40      1810\n      Digust       0.57      0.35      0.44       206\n        Fear       0.91      0.88      0.89     12716\n       Happy       0.78      0.85      0.81      7672\n         Sad       0.90      0.93      0.91     16902\n    Surprise       0.60      0.38      0.46       844\n\n    accuracy                           0.85     41609\n   macro avg       0.70      0.63      0.66     41609\nweighted avg       0.85      0.85      0.85     41609</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a1682a723f48e5861f0932f6ab3bce7d/13e20/reg.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.4054054054054%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAAD6UlEQVQ4y02U+09TZxjHm+yPkdIL6+2cMqrlKrKyn5xxLnHGZIXI5CooUOYStpG4GHEkjoQtggIN2xJZTBbddBfEISYOcRN0tAIF6oHS9rTn9H7hu+c9dZeTvDnvyXmfz/t9nu/zviorz8P6xn7wjpOoPOxEa3tnYbR14HRzK5qa23DqdOHd1NwBZ1M7TjW3o7unF+8cexcmowlGYwV4vhRWKw8VbzHBbKtG8Zmf8Pbni4gnckikAYneUhIQxAyC8h5CUg5+MYe552F4txNgz7h7Cvv2FUFT0gCO209ADirObIK9+hD6v1nG0O01zKyE8MgXhZzMISRnsbGbhIcA86sRLKxLeLwaheelrACvjbtRVKRGia0LFu5AAWg0GuGor0c6kYQQTaPl2z9x+Zc1ZLM5ROIZPN+M4oFXxMW7K5heFPDCL8O3E0OegKPXJxWgoe4jcKXlsPIWqEwmE9501GODFq0GUvjuSQC3l4NY2JLwBwVvksJlfww/PAvinkfEnCeCZfr3f4Xc0QHwZZX/AWvrHJhf2sbSRgxiNEUpxtB/6xncv/uRJinhRB7rgozF9Si+nFnD7EpQAY6Nk0K1Grb3L4KzVcDKMSClzBSu78jYjmQRprpthdOY35Tw44IfH1+4A/eNJwhIWXiFONUyihWhUMPrE24FWNs2hNIDVeAZUK/Xw0HAUERGnOTsigmEpbQS8OusFypVI44eH1O+JTJKCMbJ8RT2XilUE/CIaxhl5dXgLeaCKfX1byESS4E8oMVMZQ5ZCvD6RFwY/BmXrsyi/7MZTE0vIRzPYzuc/LeGDNgwMAJbeRU4BmQpM4W7oqS0ylYgjkAkrWwgJbJK4Pd3PFC91oXjjTeU75CUUTZkLhcXq3Fu8CrsVTWwKEDTK4VySmloMZZDlExIZvdogzylmcfTv4L44uojDA3fR0vLBCanHirg0WuFlAeujKOCAc0ENBgMZIoDgSAppNMhUn1kUsYUysmsUtNoLKMAbt5coJo60Oj8qgAcGyeFxbg84kZlVXUByNqGKRTpnDE17GQIYprU5kkpmUCOe8jduRcR3Hrgw+DQXYxNP8bMyyz6Lo2gRKvB8OgUqmsOwvyPQlZDOZkB8agHk/BH8kr/xahQm6EMloQUJh8KuLcaQ4Ls/c0Xx6ezO3B+MgyTXouJr6dRc7C2AOQ4Dna7nW4PF3r7zqOtqxed3X1w9X2IHtd5nDnnQmuXCyc+6EJDazc6OnvgbDmLI01nUXf4GNhd8N6Jkygrs4GxVFarVZloNBrodFrolaGDVqtVhlpdBB2lZSjRoYTUaGnd63odDDS3kKEsnmXJs2uQ5n8Dfq+DfwGfs8EAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"fig:\"\n        title=\"fig:\"\n        src=\"/static/a1682a723f48e5861f0932f6ab3bce7d/fcda8/reg.png\"\n        srcset=\"/static/a1682a723f48e5861f0932f6ab3bce7d/12f09/reg.png 148w,\n/static/a1682a723f48e5861f0932f6ab3bce7d/e4a3f/reg.png 295w,\n/static/a1682a723f48e5861f0932f6ab3bce7d/fcda8/reg.png 590w,\n/static/a1682a723f48e5861f0932f6ab3bce7d/13e20/reg.png 741w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><code class=\"language-text\">SGDClassifier and LogisticRegression has the accuracy 0.8486.</code></p>\n<h4>MultinomialNB:</h4>\n<ul>\n<li>\n<p>Naive Bayes family of algorithms is popular machine learning algorithms for creating text classification models.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Model Performance metrics:\n------------------------------\nAccuracy: 0.7892\nPrecision: 0.7725\nRecall: 0.7892\nF1 Score: 0.7636</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Model Classification report:\n------------------------------\n          precision    recall  f1-score   support\n\n   Anger       0.80      0.24      0.37      1459\n     Bad       0.38      0.11      0.17      1810\n  Digust       0.00      0.00      0.00       206\n    Fear       0.85      0.85      0.85     12716\n   Happy       0.79      0.74      0.76      7672\n     Sad       0.77      0.94      0.84     16902\nSurprise       0.67      0.07      0.12       844\n\naccuracy                           0.79     41609\nmacro avg       0.61      0.42      0.44     41609\nweighted avg       0.77      0.79      0.76     41609</code></pre></div>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3cbba2ed660e762217312a4cc95d328f/c54b3/nb.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.4054054054054%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAAD0UlEQVQ4y2WT60+bZRjG+XOUtvRED5S2HAQM21zEjMM4DF1mskWyGSYThFQz9ZMfNH7aYqKJH5wmhKkjCww3F6AcJnMoA8KxJ9rSQg+0L7SlLT+ft7BF44frvZ/ceZ4r131d91tkNBqwlFv56tshvv9lgscTM0xOPcE5/YRx5yw/P5jk7ugkD8dn+HXMSX3/Hc4M3OH3qTnuj4xRWWVDqapDra7HbC6lyGgwUG61cc+5xlN3GikNmRxkgXQePJEcrt0sibR8ztJ4e5GWbxZJiAvBUITaGjtKbTMlpW2UmbXHhHZ7BQsrbnalHJ7wPt6dFMlUlr2DLH9uxJldjfHHWozx5QjXB5fou7tMPH2E2xfktSorJZZONNZ3MBvVFBkKhHbWXV4ODo/YCEpsbEuC7JCYlGF2JcrE4i6PF3YYnQ/hGF7h85E1Yqk8Lm+AmqpyNNWX0NddxmwoeUFYweKaj3gKYvtZ4ge5AnlSzLy0JfHcmyS8d8iKL0nteyPUXx0hIuXxBcNU2y3oT1/GeLYLk151PLJNKJxfdrGTyJEQypKpQyQxcnz/kOeePRbccZJifJc/galpCEvLENvRDO6tINU2C+ZzXViarmHUKikqLdVjr6hg3e0nLcJIio8kIAcTiqZovDhYwJbwNpLMMjobYOxJAMGPxx+i0lpGZdv71HR+gEEjCHU63UsPhSj29jMFpLLySAk0tlto7bdYcUfFBBm8uyl8kVSBcFN4WCEIT128zhvv3kCvVpx4KBRuev0I2wSZWBFxW/ZQPk/O+bn3aJN2xwSdN51ML0dZEl6mcscKbRYzjVd6aOnqRatS/DdlWWEsmRbInKyN8DNzxLpI3tA5jOHtYR7MBZjfiCIWAJcvgLXMTOfVXi51D6D+N+ELhVJK9jDPfiZfqLsi3WAkzbPVKI9mfJw+8yUNb31NRPS3tnfEMpu40t1PV48DlbJYDqUUm83O2olCOeXjpLOFGo6lRDgHZPJHeP1Ril+5gUrxIcGwhDewjdlk4lrPAN29n6BUvPp/hTFJXpdcgVzew7nNPZyrcR6Kv+T+32E++/EpXww+I5TIs+rZxmg00vPRx/Q5PkVRfEJos9lYXt0opBvYSRQQSxwQikn89leQ4bktfprx8MO0h9tTLr6bdeMSayTvrkzY1+9gwHGTYpnQJCSXlVloam6ho+MCrW3tAh20tcu4QENTq0AbZ8+dL+D1Nxs51dBMS2u7eHMe+X1tbZ1ALbJ9RWazudDUaDRo1Orj+hJqYbSCEpUSnVaDXqdFJ3qloqrFXa3oye/lKWXI538AJ0WTEwelcCMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"fig:\"\n        title=\"fig:\"\n        src=\"/static/3cbba2ed660e762217312a4cc95d328f/fcda8/nb.png\"\n        srcset=\"/static/3cbba2ed660e762217312a4cc95d328f/12f09/nb.png 148w,\n/static/3cbba2ed660e762217312a4cc95d328f/e4a3f/nb.png 295w,\n/static/3cbba2ed660e762217312a4cc95d328f/fcda8/nb.png 590w,\n/static/3cbba2ed660e762217312a4cc95d328f/c54b3/nb.png 727w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h4>Pipeline with CountVectorizer, TfidfTransformer, MultinomialNB:</h4>\n<ul>\n<li>\n<p>As pipeline often gives promising results to the initial model itself.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Model Performance metrics:\n------------------------------\nAccuracy: 0.7225\nPrecision: 0.7134\nRecall: 0.7225\nF1 Score: 0.6791</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Model Classification report:\n------------------------------\n          precision    recall  f1-score   support\n\n   Anger       0.92      0.01      0.02      1459\n     Bad       0.00      0.00      0.00      1810\n  Digust       0.00      0.00      0.00       206\n    Fear       0.85      0.78      0.81     12716\n   Happy       0.88      0.51      0.64      7672\n     Sad       0.64      0.96      0.77     16902\nSurprise       0.00      0.00      0.00       844\n\naccuracy                           0.72     41609\nmacro avg       0.47      0.32      0.32     41609\nweighted avg       0.71      0.72      0.68     41609</code></pre></div>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d63e90c7905873d607ffdf459df78d8f/a0209/pipe.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.43243243243244%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAADq0lEQVQ4y22U7U9bZRjG+VP8xsboC6UtBfoS2AZMZ/QDG9HoBs4wAbvyUlgUTWayF7MvqHHJvphtitkUYeiGM/ugWfxituimm5owC7S0tPQN+gJtoeXn/ZxCmIknufLc5+Q8v1znuu/nVNTV1dHQ0EBvn5sh7zADg14Gh4bpHxjE7emnu/eUJlX3uQewNHRQazvKKc+QqB+7o5HaWrvIic1mpcJiseBwOPDNhygUYb2wxfrGFvlNWJN6IZZnbjlHTu7DsRz1LeOYm66yJM+jiVUOHTpAle5FdMYO6utNZaDT6cS3UAZm80UBlQRcIiP17NIafwezJDKbLISz1Ld/jeXlG4QTBZYF2NbahM7SgaH+DWx1hl3g07mA5iy9ViAlyoillWyBh74V7s8m8AnskdTNp3/G5b3HYjzH0nKctpYm9PbXqWnqwWbRbwNdLuYDSwiv7E6KnCibL2nunvgzRNOb+MSt/dgUtlcniKxsEE2maD3gouZAF+bDHmxm/a7DWZ+/7HB9Q5NymFrbIJ6Rjam8ZFgiGEmhq71Ipe4c/lBaMk3Qut8lsDexHRmkzlRdBrrE4Vwg9F+Hmwpe5Mbdecbv+FhdKxJbzdM3couTQ9PEU2WHB5ucNLa/hevYCBajAE0mk3R5J0M0dyrD3EaRYDSLrn2KypcmJK8sm+LySSDNY39KGlZiMRzjYLOL5lf6eL57FLNBgGazuZzh4hIyGZpDNS7SYJLS2dFLvzE09oC7j2Pcm11h8kGY6V/DSBIsx1fZ73JwuNPNEff7mHT7tufw2S6v73Y5pXVcxiW2Ruf4X7R/9gcjM0+58NM80ewmoUiMJpeTo90eurxnMFZXUWHdzvBZhwqspJyq+Qsm8lz5JcwnP/p57YPvOXH2jjRLMpUMXQ47x3vkVL1zFr0Cqk9WJ+X/5lCtyXSeRCpHsbTF8vIqhkove57z4A+uEIkncQrwpNvL8HvnqN63d2dsXHJSglpumdwGWYGpE6Oggeg685EssXSBf4IprC98iqnlY0ISgzp6dnsjfZ5h3j1zYReoHAYjcdRV3JZMkDZGf4YKPPLnCSS3tLrtw99pOf+QZF4mIpsToB3v6VHOXxyjau8eydBq1R5e++JLbs38wM1vb3PzuxmmRVNSX742yaUrk1y9Ps3lzydxnPgIe9cY1ydv89XEN9qf6nhnFz29b6PX66iw2WwoGQx6kUGTcWc1yiovqVWpxmjEXGPAaq6RzXrtPbVXfaXqhar/BYyylAaQJvzgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"fig:\"\n        title=\"fig:\"\n        src=\"/static/d63e90c7905873d607ffdf459df78d8f/fcda8/pipe.png\"\n        srcset=\"/static/d63e90c7905873d607ffdf459df78d8f/12f09/pipe.png 148w,\n/static/d63e90c7905873d607ffdf459df78d8f/e4a3f/pipe.png 295w,\n/static/d63e90c7905873d607ffdf459df78d8f/fcda8/pipe.png 590w,\n/static/d63e90c7905873d607ffdf459df78d8f/a0209/pipe.png 725w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><code class=\"language-text\">MultinomialNB and .Pipeline with CountVectorizer, TfidfTransformer, MultinomialNB have accuracy  0.7892 and 0.7225.</code></p>\n<h3>The Deep Learning models used are:</h3>\n<h4>CNN model:</h4>\n<ul>\n<li>Deep learning algorithms with CNN is expected to work well with text classification</li>\n<li>\n<p>CNN with and complied using loss = ‘categorical_crossentropy’ , optimizer = adam , metrics = accuracy\nModel: </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">_________________________________________________________________\nLayer (type)                 Output Shape              Param #   \n=================================================================\nembedding_1 (Embedding)      (None, 157, 500)          54695500  \n_________________________________________________________________\nconv1d_1 (Conv1D)            (None, 157, 128)          192128    \n_________________________________________________________________\nconv1d_2 (Conv1D)            (None, 157, 64)           24640     \n_________________________________________________________________\nconv1d_3 (Conv1D)            (None, 157, 32)           4128      \n_________________________________________________________________\nconv1d_4 (Conv1D)            (None, 157, 16)           1040      \n_________________________________________________________________\nflatten_1 (Flatten)          (None, 2512)              0         \n_________________________________________________________________\ndropout_1 (Dropout)          (None, 2512)              0         \n_________________________________________________________________\ndense_1 (Dense)              (None, 100)               251300    \n_________________________________________________________________\ndropout_2 (Dropout)          (None, 100)               0         \n_________________________________________________________________\ndense_2 (Dense)              (None, 7)                 707       \n=================================================================\nTotal params: 55,169,443\nTrainable params: 55,169,443\nNon* trainable params: 0</code></pre></div>\n<p><code class=\"language-text\">trained the model which produced Accuracy: 84.063542, Loss: 45.061589. Which is less the ML models.</code></p>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8217a171c47bae506806defcadef9a9e/8ae3e/cnn.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 83.1081081081081%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADAUlEQVQ4y12TO2tcRxTHFwxuUqVx6e/gIkWIq3yDNEnnBJxCjSrbBAeChdQIEkiIAsGBYFtubD1wYmNFgWAJjFDQKqvIK1mrXela+969u3fe75m763N1ZRA+xTDMzO/8z2sK43c2OrU0TWHlnA8GA4wxQgjWEMLpfTo6vc1fw1LI91EXf/bLxu2lV0xoIgxhspewahNFHXLSxScx32ug1lBwaZS2zvvv5p5Srgu5n/Kb3pXpta/ulYiwRHlhAlbhsMOjga60aaUr/otQPdFce2Ud0F9MLYP3Qh4zE2q/lT3aa7LjWBk/ipkr1+mfu72Jxf27G42jnmgho9xIWw/w1z+vDajKYUhSCOWQ8NsRqvYE0F1ito+SR8XW5w92flx/c9imjUzZKZMpT/6+iYU9C7s9pLP/1B4W20g4LL12KZKh0pWvIeAT/LKWzG+dFBvYhTHAzodvHm8nLFcepfU+ml49uL/V5MoxHaT1PaJf/N8sRcN2onYa5N5mVKxjbYPUGTzzrIyELkAbFJg2XaIS6ZjyTEFjxqubtQsf3bo+s2zTcY/axlAmwkmb5spza1VufAZLKYEW2hk3otJR5QH++9/aB598++XUwmEDVVskpppIz6DaBtgwv3nMlMnChsFgXBCZBQxlAGVpw4Dq4w65+0fx4se3J394BqXBWVAZDHrPd+tC2zOYCwkwNykWLoepCm48Xlo/+PDTqYnZJ/tR/7iNIWwJeYewUe1an571WUgFmgAz6YRJYRi4DkNm+ljD+W9LG4XL125+vwwvudQhpLsRDIM9g6XSuTKVGQbKTKddrFtID81o/q/Spas37vy6otLxkCqY8ForMdZlsHOWMA4Y0QFex9wpl0KFt47Q83L/zsrrhZ12H0lo2OJ2q9zE0NvmgIZ0lMGQA+ScUAGta8Y0JopJ3cOydDRYr8Q/vThY3e9gpiod+rTUqLQRIDGixr4LG4xSCl6EkM452HvvCaFamwQTmEc4h9QQJvApcz0oc+H8fz6/yV3ACLz34cfn7C3f+5x0jeI9KQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"fig:\"\n        title=\"fig:\"\n        src=\"/static/8217a171c47bae506806defcadef9a9e/fcda8/cnn.png\"\n        srcset=\"/static/8217a171c47bae506806defcadef9a9e/12f09/cnn.png 148w,\n/static/8217a171c47bae506806defcadef9a9e/e4a3f/cnn.png 295w,\n/static/8217a171c47bae506806defcadef9a9e/fcda8/cnn.png 590w,\n/static/8217a171c47bae506806defcadef9a9e/8ae3e/cnn.png 756w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h4>Bidirectional LSTM model:</h4>\n<ul>\n<li>removed the spatial dropout layer as it decreases the accuracy of the model, which is inferred from training</li>\n<li>\n<p>CNN with and complied using loss = ‘categorical_crossentropy’ , optimizer = adam , metrics = accuracy</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Layer (type)                    Output Shape         Param #     Connected to                     \n==================================================================================================\ninput_1 (InputLayer)            [(None, 157)]        0                                            \n__________________________________________________________________________________________________\nembedding (Embedding)           (None, 157, 500)     54695500    input_1[0][0]                    \n__________________________________________________________________________________________________\nbidirectional (Bidirectional)   (None, 157, 256)     644096      embedding[0][0]                  \n__________________________________________________________________________________________________\nconv1d (Conv1D)                 (None, 155, 64)      49216       bidirectional[0][0]              \n__________________________________________________________________________________________________\nglobal_average_pooling1d (Globa (None, 64)           0           conv1d[0][0]                     \n__________________________________________________________________________________________________\nglobal_max_pooling1d (GlobalMax (None, 64)           0           conv1d[0][0]                     \n__________________________________________________________________________________________________\nconcatenate (Concatenate)       (None, 128)          0           global_average_pooling1d[0][0]   \n                                                             global_max_pooling1d[0][0]       \n__________________________________________________________________________________________________\ndense (Dense)                   (None, 7)            903         concatenate[0][0]                \n==================================================================================================\nTotal params: 55,389,715\nTrainable params: 55,389,715\nNon-trainable params: 0</code></pre></div>\n</li>\n</ul>\n<p><code class=\"language-text\">The Bidirectional LSTM has the highest accuracy of all the models Accuracy: 86.488497, Loss: 36.384022</code></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/126eeb9613e7e7a1114488a1fd549d61/d67ca/lstm.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 85.8108108108108%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADIUlEQVQ4y02TW4scRRTH+1PsF1DRDyKITz4JPvmkECHgBWTRh7BiHoSQEELEh3jJKgY2ygoxWTSbLGKSdbMz7k4SdHZ2Z8ZJunumr1Vd96qu6u6cnlkWz0Nzuqp+dS71P14zN6FtzrUpXV3XprQ5QmmW5TnKclQQ4lxlXQXfqq6rqoLzjCv48eq6aWr7ydrfLy9v/NYLOVcpkXFO/IQOnmWTqJjM0HBG90dpiASmkkkF8Luf/Rjl1Kvqxhm5vLb/yqebv/ZmGTU5t1TZlLtJIsLCPM34MJa9SRFRS2UplAH4zZV1P8YeeLYs/ZSGSH6z47+//qTrE2uraWHGEd8apFe2R7sT7KciY+UJ/PaFO35CWlhrTbhsqubqbvDe9UfbE8xkGSA9mrE7B8lX9462x/kooik1RJgFfOrKdlzIFlZSznLu52qcysOIbg6S73ZGj0OKqBln8iAkv/eTL+8dPZpSqSyfwx9d60xzdgwHKRvFIiGGcAPw5T8POxMcJOxZrqa5un0Qn9vq7wVEabeAz/zSizD3lFJGayo0Ua4QNiUmYaZQ7uNLG0uvrqxu9Mq6CbH+L+VIWKbsIu0Lm30kjCda41Qori3wCVFMO9h+5+zP3gunLq39pWyd0xIzzbUruF7A3z44Qkwed5tLI8saCxsVmuoK/GFYPB7GH168tfTa51dv7YMaiHQnkdf3xpjPYUppwSRswAsHmaCqgq7KslXS6XM3vBdPn792H1qFWHkS+Y9+KI1tYWct1MxNRZVDvARHgK+rQton42zn3+nyxRsvvX7mh5tduA8KBGRvGAttjt8ZU0FECXBOFcBEaKarpFBEWjjwwRc/eUtvnV+9C9kQ3sJ90J1UoO1aSlCslqYKsRlMoasOcs6FC5DqT/nuCN//Z3r34eD7B5OV2+Otgxhg0HzpqhZmjCLCC6aGEesM0wgCMjnF6jDE3TG+2fUHM6aNXd0N3/i6c737FOAgwTCD3mIkuRCMc+h5hhnjklIYHlNQgagI4pwpw4X0M9oZgq50qyttwI5hN7d6btZa8KEWjJFWql1v2vXKWWht8z97DoTTlZCGwDpDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"fig:\"\n        title=\"fig:\"\n        src=\"/static/126eeb9613e7e7a1114488a1fd549d61/fcda8/lstm.png\"\n        srcset=\"/static/126eeb9613e7e7a1114488a1fd549d61/12f09/lstm.png 148w,\n/static/126eeb9613e7e7a1114488a1fd549d61/e4a3f/lstm.png 295w,\n/static/126eeb9613e7e7a1114488a1fd549d61/fcda8/lstm.png 590w,\n/static/126eeb9613e7e7a1114488a1fd549d61/d67ca/lstm.png 714w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<blockquote>\n<p>I also found from the observation that the LSTM model works better for Sad, Happy, and Fear but the SGDClassifier works better on Anger, Bad, Surprise hence joined the model together making it a stacked model which provided a accuracy:</p>\n<ul>\n<li>Accuracy: 0.883606912</li>\n<li>Precision: 0.8874248006</li>\n<li>Recall: 0.883606912</li>\n<li>F1 Score: 0.8844271224 </li>\n</ul>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0f90d139b445da2bd44f1e144e2d977d/6e9ba/stack.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 85.8108108108108%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADEUlEQVQ4y01TS29VVRQ+f8QJhIF/waE/QBIHJMaJcWQcOJAJxQkxDTBxQEDTABIKOqA1BKm0VUFNhNpCoe2F1tJ7vb29j9Pzuvv93mff6zo9pWEl57nXt771fSsrGh/G6ChCKDnnhBBWBYV3+FUf1Al1OtyicPCYf9Z+b2Luu4UtYxwWOhuSQYbb/byf4f0cZ0TtpWzINBVaG2esO399gQkNYMCGqflGdPLm6enn2niiApEOq9BJeS7KnOmEutcxLYSnwhrrpbYfnbubYxHVXXQz+mQr/el5fHa+Ob9VhDDOmO/kanWP/NyI13p0n1gkvTAlMCvjPr30RzpkUcUbAuUCdDzcKU5Nr/+wGittY2qb++zvVnHtcXNpF/ULCWAiTA3+4sYKFiaq7SJcJUS3C93o03uN9MyDnbnNnErfRXonFS+69LfNtJUr7UYA1tafubOGuKrAYGOBeSdjOXNg2IPN7NSttemn/TijMdIJVhs9OvN0bzsRXFW0xvnJX14OqYi898YYoQyYRHWJhOth08bm0uzyux9evDyzJGyIiekOFVKHmgF85a8W1y4yxsI0uZBUGG5CTg3TJbTzze0/oxOfffXtAmjLqUXMCANTsAC23t9a2WXyjWYhNdcewAWzwK9d+C8myy+7564+PP7B+csz/4TxmOnAlAcvnS/vb3SZrDWPAmWSSgvgFKkqSVppIX88eeNRdOLziSuLwDnkFnMrK7BfaqXGlRXYOQfMVDphR0R5aUegDUogYVsDst5Mvp5afOf9iamZx5AsFXRdNjqFMrYCW2sol4RXqhC3UIKrqouManqg/8L3v0bHPpm8uijciAhdlmVzgJU+0AwfXCjQg2XZyWXBvXIByXKA9EafLbxKnrxO17f7Py53v7y/8/u/KQjtD6UvQ81sMWWIqpTo7R5OsCZcZ8zsJnR1F82utBs9CvOfXdv/+PaLucYAICnixtpDt0EGJhTWBapoY4WQ4CoiFPpPhgQzgTEtqNzqpkzbis+Baz462mZo/mi34VJKF0VhjK51VacHKz1+K/4HE3qZoGUcHf8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"fig:\"\n        title=\"fig:\"\n        src=\"/static/0f90d139b445da2bd44f1e144e2d977d/fcda8/stack.png\"\n        srcset=\"/static/0f90d139b445da2bd44f1e144e2d977d/12f09/stack.png 148w,\n/static/0f90d139b445da2bd44f1e144e2d977d/e4a3f/stack.png 295w,\n/static/0f90d139b445da2bd44f1e144e2d977d/fcda8/stack.png 590w,\n/static/0f90d139b445da2bd44f1e144e2d977d/6e9ba/stack.png 731w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Preprocess:<br>\n<a href=\"https://colab.research.google.com/drive/1NZBf4iDojvel3dHeU9AYzWWt5XM8Eggr\">https://colab.research.google.com/drive/1NZBf4iDojvel3dHeU9AYzWWt5XM8Eggr</a><br>\nMachineLearning:<br>\n<a href=\"https://colab.research.google.com/drive/1UI4LPO9BfrkJYXEVudsii7XRXeVJXvJJ#scrollTo=HP6QeD8vzjKc\">https://colab.research.google.com/drive/1UI4LPO9BfrkJYXEVudsii7XRXeVJXvJJ#scrollTo=HP6QeD8vzjKc</a><br>\nDeep Learning:<br>\n<a href=\"https://colab.research.google.com/drive/1gauXKeBIN9Piln_2_OxmLsk5g8U9f1f-#scrollTo=TKyIf6PhJRfE\">https://colab.research.google.com/drive/1gauXKeBIN9Piln_2_OxmLsk5g8U9f1f-#scrollTo=TKyIf6PhJRfE</a><br>\nStacked Model:<br>\n<a href=\"https://colab.research.google.com/drive/191BIy6tGDRfIi6eKNFhLM2IN7quwFdyr#scrollTo=ROunJKQlz_Lr\">https://colab.research.google.com/drive/191BIy6tGDRfIi6eKNFhLM2IN7quwFdyr#scrollTo=ROunJKQlz_Lr</a><br></p>","frontmatter":{"title":"Emotion Analysis using Machine Learning Part-2","date":"June 22, 2020","description":"Result of the previous post"}}},"pageContext":{"slug":"/week_2/","previous":{"fields":{"slug":"/week_1/"},"frontmatter":{"title":"Emotion Analysis using Machine Learning Part-1"}},"next":{"fields":{"slug":"/week_3/"},"frontmatter":{"title":"Deploy Machine Learning Model for simple use."}}}}}